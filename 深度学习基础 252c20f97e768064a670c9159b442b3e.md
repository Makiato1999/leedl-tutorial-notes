# æ·±åº¦å­¦ä¹ åŸºç¡€

åŒºåˆ«å±€éƒ¨æå°å€¼ local minimum vs éç‚¹ saddle point

- å±€éƒ¨æå°å€¼ï¼šçœŸæ²¡è·¯èµ°äº†ï¼Œå·²ç»æ˜¯æœ€ä½ç‚¹ï¼ˆåªèƒ½æ¥å—ï¼‰ã€‚
- éç‚¹ï¼šè¿˜å¯ä»¥èµ°ï¼Œåªæ˜¯æŸäº›æ–¹å‘çœ‹èµ·æ¥â€œå¹³å¦â€æˆ–â€œè¯¯å¯¼â€ï¼Œå¯¼è‡´æ¢¯åº¦ä¸‹é™æ–¹æ³•åœåœ¨é‚£ã€‚

çº¢ç‚¹æ‰€åœ¨ä½ç½®åƒâ€œé©¬éâ€ï¼š

æ²¿ x æ–¹å‘çœ‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªä½ç‚¹

æ²¿ y æ–¹å‘çœ‹ï¼Œå®ƒå´æ˜¯ä¸€ä¸ªé«˜ç‚¹

ç‰¹å¾ï¼šæ¢¯åº¦ä¸º 0ï¼Œä½†ä¸æ˜¯æœ€ä½ç‚¹

æ¨¡å‹è®­ç»ƒå¯èƒ½åœ¨è¿™é‡Œå¡ä½ï¼Œå› ä¸ºæ¢¯åº¦ä¸‹é™æ³•åªä¾èµ–æ¢¯åº¦ä¿¡æ¯ â†’ æ¢¯åº¦æ¥è¿‘ 0 æ—¶ä¼šåœæ»

![Screenshot 2025-08-17 at 4.54.36â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-17_at_4.54.36_PM.png)

### å¦‚ä½•é€šè¿‡æ•°å­¦æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªä¸´ç•Œç‚¹ï¼ˆæ¢¯åº¦ä¸º 0ï¼‰åˆ°åº•æ˜¯å±€éƒ¨æå°å€¼ã€å±€éƒ¨æå¤§å€¼è¿˜æ˜¯éç‚¹ï¼Ÿ

ç”¨æ³°å‹’å±•å¼€è¿‘ä¼¼æŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬æŠŠæŸå¤±å‡½æ•°åœ¨ Î¸â€² é™„è¿‘å±•å¼€ï¼š

- ç¬¬ä¸€é¡¹ï¼šå¸¸æ•° L(Î¸â€²)
- ç¬¬äºŒé¡¹ï¼šå’Œ æ¢¯åº¦ g æœ‰å…³ï¼ˆä¸€é˜¶é¡¹ï¼Œè¡¨ç¤ºå¡åº¦ï¼‰ã€‚
- ç¬¬ä¸‰é¡¹ï¼šå’Œ Hessian çŸ©é˜µ H æœ‰å…³ï¼ˆäºŒé˜¶é¡¹ï¼Œè¡¨ç¤ºå¼¯æ›²ç¨‹åº¦ï¼‰ã€‚

Hessian é‡Œçš„å…ƒç´ æ˜¯â€œäºŒé˜¶åå¯¼æ•°â€ï¼Œå› ä¸ºå‡½æ•° f(x,y) æœ‰å¤šä¸ªå˜é‡ï¼Œæ¯ä¸ªæ–¹å‘éƒ½å¯ä»¥åˆ†åˆ«æ±‚å¯¼ã€‚

Hessian > 0 â†’ ç¢—å£å‘ä¸Š â†’ è°·åº•ï¼ˆæå°å€¼ï¼‰

Hessian < 0 â†’ ç¢—å£å‘ä¸‹ â†’ å±±é¡¶ï¼ˆæå¤§å€¼ï¼‰

Hessian æœ‰æ­£æœ‰è´Ÿ â†’ é©¬éå½¢ â†’ éç‚¹

![Screenshot 2025-08-17 at 5.42.10â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-17_at_5.42.10_PM.png)

![Screenshot 2025-08-17 at 6.59.23â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-17_at_6.59.23_PM.png)

![Screenshot 2025-08-17 at 6.59.48â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-17_at_6.59.48_PM.png)

å¯¹ç§°çŸ©é˜µçš„ç‰¹æ€§ï¼šä¸€å®šå¯ä»¥è¢«æ­£äº¤å¯¹è§’åŒ–ï¼Œç‰¹å¾å€¼ä¸€å®šéƒ½æ˜¯å®æ•°ã€‚

ç‰¹å¾å‘é‡ï¼šä¸ä¼šè¢«çŸ©é˜µæ—‹è½¬çš„æ–¹å‘ã€‚

ç‰¹å¾å€¼ï¼šçŸ©é˜µåœ¨è¿™ä¸ªæ–¹å‘ä¸Šçš„æ‹‰ä¼¸å€æ•°ã€‚

åœ¨ Hessian åœºæ™¯é‡Œï¼Œç‰¹å¾å€¼çš„ç¬¦å· = å¼¯æ›²æ–¹å‘ã€‚

Hessian çš„å…³é”®ç‰¹æ€§æ˜¯â€œå¯¹ç§°â€ï¼Œè¿™ä¿è¯äº†å®ƒçš„ç‰¹å¾å€¼èƒ½çœŸå®åæ˜ å‡½æ•°çš„æ›²ç‡ã€‚é€šè¿‡ç‰¹å¾å€¼çš„ç¬¦å·ï¼Œå°±èƒ½åˆ¤æ–­ä¸´ç•Œç‚¹æ˜¯æå°å€¼ã€æå¤§å€¼è¿˜æ˜¯éç‚¹ã€‚

ä¹¦ä¸Šçš„ä¾‹å­ï¼ˆ3.6ï¼‰

![Screenshot 2025-08-17 at 9.15.17â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-17_at_9.15.17_PM.png)

![Screenshot 2025-08-17 at 9.15.28â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-17_at_9.15.28_PM.png)

ç”¨è¡Œåˆ—å¼ det(Hâˆ’Î»I) è®¡ç®—ç‰¹å¾å€¼ 

det(Hâˆ’Î»I) = (âˆ’Î»)(âˆ’Î»)âˆ’(âˆ’2)(âˆ’2) = Î»^2âˆ’4

Î»^2âˆ’4 = 0 â‡’ Î» = Â±2

![Screenshot 2025-08-17 at 9.17.23â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-17_at_9.17.23_PM.png)

å®é™…ä¸Šï¼Œæˆ‘ä»¬å‡ ä¹ä¸ä¼šçœŸçš„æŠŠæµ·æ£®çŸ© é˜µç®—å‡ºæ¥ï¼Œå› ä¸ºæµ·æ£®çŸ©é˜µéœ€è¦ç®—äºŒæ¬¡å¾®åˆ†ï¼Œè®¡ç®—è¿™ä¸ªçŸ©é˜µçš„è¿ç®—é‡éå¸¸å¤§ï¼Œè¿˜è¦æŠŠå®ƒçš„ç‰¹å¾å€¼ è·Ÿç‰¹å¾å‘é‡æ‰¾å‡ºæ¥ï¼Œæ‰€ä»¥å‡ ä¹æ²¡æœ‰äººç”¨è¿™ä¸ªæ–¹æ³•æ¥é€ƒç¦»éç‚¹

æ·±åº¦å­¦ä¹ é‡Œå±€éƒ¨æå°å€¼ä¸å¤ªå¯æ€•

- ç¥ç»ç½‘ç»œåŠ¨è¾„æœ‰ ç™¾ä¸‡ç”šè‡³ä¸Šäº¿ä¸ªå‚æ•° â†’ è¯¯å·®è¡¨é¢æ˜¯ä¸€ä¸ª é«˜ç»´ç©ºé—´ã€‚
- åœ¨é«˜ç»´ç©ºé—´é‡Œï¼ŒçœŸæ­£â€œå°é—­â€çš„å±€éƒ¨æå°å€¼å¾ˆå°‘ï¼Œå¤§å¤šæ•°ç‚¹åªæ˜¯ éç‚¹ï¼šåœ¨æŸäº›æ–¹å‘ä¸Šæ›²ç‡æ˜¯æ­£çš„ï¼ˆåƒè°·åº•ï¼‰ï¼Œåœ¨å¦ä¸€äº›æ–¹å‘ä¸Šæ›²ç‡æ˜¯è´Ÿçš„ï¼ˆåƒå±±è„Šï¼‰ï¼Œæ‰€ä»¥è¿˜å¯ä»¥ç»§ç»­ä¸‹é™

# æ‰¹é‡å’ŒåŠ¨é‡

éšæœºæ¢¯åº¦ä¸‹é™ (Stochastic Gradient Descent, SGD)ï¼Œå°æ‰¹é‡æ¢¯åº¦ä¸‹é™ (Mini-batch Gradient Descent)ï¼Œä¸¥æ ¼æ¥è¯´ï¼šâ€œSGDâ€è¿™ä¸ªè¯åœ¨è®ºæ–‡/ä»£ç é‡Œç»å¸¸é»˜è®¤å°±æ˜¯ mini-batch SGDï¼ˆè€Œä¸æ˜¯å•æ ·æœ¬ï¼‰ï¼Œåªæ˜¯å†å²å‘½åæ²¿ç”¨ä¸‹æ¥è€Œå·²ã€‚

### å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆmini-batch gradient descentï¼‰ å’Œ k æŠ˜äº¤å‰éªŒè¯ï¼ˆk-fold cross validationï¼‰ å®Œå…¨ä¸æ˜¯ä¸€å›äº‹!

å°æ‰¹é‡æ¢¯åº¦ä¸‹é™

- è¿™æ˜¯ **è®­ç»ƒæ—¶çš„ä¸€ç§ä¼˜åŒ–ç®—æ³•**
- ç›®çš„ï¼šè®©å‚æ•°æ›´æ–°æ—¢å¿«ï¼ˆä¸åƒå…¨é‡é‚£ä¹ˆæ…¢ï¼‰ï¼Œåˆç¨³ï¼ˆä¸åƒå•æ ·æœ¬é‚£ä¹ˆæŠ–ï¼‰
- åšæ³•ï¼šæŠŠè®­ç»ƒæ•°æ®åˆ†æˆä¸€æ‰¹ä¸€æ‰¹çš„ï¼ˆbatchï¼‰ï¼Œæ¯”å¦‚ batch size = 32ï¼Œè®­ç»ƒçš„æ—¶å€™æ¯æ¬¡åªç”¨ 32 æ¡æ•°æ®ç®—æ¢¯åº¦ï¼Œæ›´æ–°ä¸€æ¬¡å‚æ•°
    
    ğŸ‘‰ å®ƒè§£å†³çš„æ˜¯ æ€ä¹ˆæ›´æ–°å‚æ•° çš„é—®é¢˜
    

k æŠ˜äº¤å‰éªŒè¯ 

- è¿™æ˜¯ **æ¨¡å‹è¯„ä¼°æ–¹æ³•**
- ç›®çš„ï¼šåœ¨æ•°æ®æœ‰é™çš„æƒ…å†µä¸‹ï¼Œå¯é åœ°è¯„ä¼°æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›
- åšæ³•ï¼šæŠŠæ•°æ®åˆ‡æˆ k ä»½ï¼Œæ¯æ¬¡æ‹¿ k-1 ä»½åšè®­ç»ƒï¼Œå‰©ä¸‹ 1 ä»½åšéªŒè¯ï¼›é‡å¤ k æ¬¡ï¼Œæœ€åå–å¹³å‡åˆ†æ•°
    
    ğŸ‘‰ å®ƒè§£å†³çš„æ˜¯ æ€ä¹ˆè¯„ä¼°æ¨¡å‹ çš„é—®é¢˜
    

batch çš„ç»„æˆæ–¹å¼ï¼Œéšæœºåˆ’åˆ† (shuffle)ï¼ˆå®è·µä¸­æœ€å¸¸ç”¨ï¼‰ï¼š

- æ¯ä¸ª epoch å¼€å§‹æ—¶ï¼ŒæŠŠ 1000 æ¡æ•°æ®éšæœºæ‰“ä¹±
- ç„¶åå†åˆ†æˆ 10 ä¸ª batchï¼ˆæ¯ä¸ª batch 100 æ¡ï¼‰
- è¿™æ ·ç¬¬ 1 ä¸ª batch å¯èƒ½æ˜¯ {1,15,17,120,...}ï¼Œç¬¬ 2 ä¸ª batch å°±æ˜¯å‰©ä¸‹çš„å¦ä¸€ç»„éšæœºçš„ 100 æ¡
- æ¯ä¸ª epoch shuffle ä¸€æ¬¡ï¼Œæ‰€ä»¥æ¯æ¬¡è®­ç»ƒçš„ batch é¡ºåºå’Œå†…å®¹éƒ½ä¼šå˜

é¡ºåºæ›´æ–° Î¸ æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

åœ¨è®­ç»ƒä¸­ï¼Œbatch çš„å¤„ç†æ˜¯ä¸²è¡Œçš„ï¼š

1. ç¬¬ 1 ä¸ª batchï¼š
    - ç”¨å½“å‰å‚æ•° Î¸0 è®¡ç®— loss â†’ å¾—åˆ°æ¢¯åº¦ âˆ‡L1(Î¸0)
    - æ›´æ–°å‚æ•°ï¼šÎ¸1 = Î¸0 âˆ’ Î· âˆ‡L1(Î¸0)
2. ç¬¬ 2 ä¸ª batchï¼š
    - ç”¨åˆšæ›´æ–°è¿‡çš„å‚æ•° Î¸1ï¼Œåœ¨ç¬¬ 2 ä¸ª batch ä¸Šç®— loss â†’ å¾—åˆ°æ¢¯åº¦ âˆ‡L2(Î¸1)
    - æ›´æ–°å‚æ•°ï¼šÎ¸2 = Î¸1 âˆ’ Î· âˆ‡L2(Î¸1)
3. ç¬¬ 3 ä¸ª batchï¼š
    - ç”¨å‚æ•° Î¸2ï¼Œåœ¨ç¬¬ 3 ä¸ª batch ä¸Šç®— â†’ æ›´æ–°åˆ° Î¸3
    
    â€¦
    
    ç›´åˆ° 10 ä¸ª batch éƒ½èµ°å®Œï¼Œä½ å¾—åˆ° Î¸10ï¼Œè¿™å°±æ˜¯ä¸€ä¸ª epoch
    

æ€»ç»“

å‚æ•°æ›´æ–°æ˜¯ çº¿æ€§çš„æµç¨‹ï¼šbatch1 â†’ batch2 â†’ batch3 â†’ â€¦

å¦‚æœ batch1 çš„æ¢¯åº¦=0 â†’ è¿™æ¬¡æ²¡æ›´æ–°ï¼Œå‚æ•°ç…§æ ·ä¼ ç»™ batch2ã€‚

batch2 å†ç®—çš„æ—¶å€™ï¼Œå¤šåŠèƒ½ç®—å‡ºéé›¶æ¢¯åº¦ï¼Œäºæ˜¯å‚æ•°å°±ä¼šç»§ç»­èµ°ã€‚

è¿™å°±æ˜¯æ‰€è°“çš„ mini-batch è‡ªå¸¦â€œæŠ–åŠ¨â€ï¼Œä¸ä¼šåƒå…¨æ‰¹é‡é‚£æ ·è½»æ˜“è¢«å¡æ­»ã€‚

å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼šè“ç‚¹è½åœ¨æ¯”è¾ƒå®½ã€å¹³ç¼“çš„è°·åº•ã€‚æ›´æ–°æ›´æ…¢ï¼Œä½†èƒ½æ‰¾åˆ°æ›´å¥½ã€æ³›åŒ–èƒ½åŠ›æ›´å¼ºçš„è§£ã€‚æµ‹è¯•æŸå¤±ä¹Ÿä¸ä¼šå·®å¤ªå¤šï¼ˆé»‘å®çº¿è®­ç»ƒæŸå¤± vs é»‘è™šçº¿æµ‹è¯•æŸå¤±ï¼‰ã€‚

å¤§æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼šè“ç‚¹è½åœ¨ä¸€ä¸ªåˆçª„åˆæ·±çš„è°·åº•ã€‚æ›´æ–°æ›´å¿«ï¼Œä½†å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œæµ‹è¯•è¡¨ç°è¾ƒå·®ã€‚æ¢åˆ°æµ‹è¯•é›†ï¼ŒæŸå¤±ç«‹åˆ»å·®å¾ˆå¤šï¼ˆçº¢è‰²è™šçº¿å¾ˆé•¿ï¼‰ã€‚

![Screenshot 2025-08-18 at 5.55.07â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_5.55.07_PM.png)

![Screenshot 2025-08-18 at 6.02.18â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_6.02.18_PM.png)

åŠ¨é‡æ³• (momentum method)

æ™®é€šæ¢¯åº¦ä¸‹é™ï¼šå†å²å½±å“è¢«â€œå‹ç¼©â€è¿›äº†ä½ç½® Î¸tï¼Œæ‰€ä»¥æ¯æ¬¡åªç”¨å½“å‰ä½ç½® + å½“å‰æ¢¯åº¦æ¥æ›´æ–°ã€‚

åŠ¨é‡æ³•ï¼šå†å²å½±å“è¢«æ˜¾å¼åœ°ä¿ç•™åœ¨ ä¹‹å‰æ‰€æœ‰æ¢¯åº¦çš„åŠ æƒå’Œ mt é‡Œï¼Œæ¯æ¬¡æ›´æ–°éƒ½ä¼šæŠŠâ€œè¿‡å»çš„è¶‹åŠ¿â€å¸¦ä¸Šã€‚

å³ä½¿åœ¨æŸä¸ªç‚¹æ¢¯åº¦ä¸º 0ï¼š

ç”±äºå‰ä¸€æ­¥è¿˜â€œæœ‰æƒ¯æ€§â€ï¼ˆè“è‰²è™šçº¿ç®­å¤´ï¼‰ï¼ŒçœŸå®çš„æ›´æ–°æ–¹å‘ï¼ˆè“è‰²å®çº¿ç®­å¤´ï¼‰ä¾ç„¶ ç»§ç»­å¾€å‰èµ°ã€‚

è¿™å°±è®©ä¼˜åŒ–å™¨ ä¸å®¹æ˜“å¡ä½ï¼Œèƒ½å¤Ÿå†²è¿‡ä¸€äº›å°å‘æˆ–éç‚¹ï¼Œç»§ç»­å¾€æ›´å¥½çš„æå°å€¼æ–¹å‘èµ°ã€‚

![Screenshot 2025-08-18 at 6.31.22â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_6.31.22_PM.png)

![Screenshot 2025-08-18 at 6.35.30â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_6.35.30_PM.png)

# è‡ªé€‚åº”å­¦ä¹ ç‡

å­¦ä¹ ç‡å¤§ï¼Œå­¦ä¹ ç‡ Î· = 10^âˆ’2 çš„ç»“æœå¦‚å›¾ 3.22(a) æ‰€ç¤ºã€‚å‚æ•°åœ¨å³¡è°·çš„ä¸¤ç«¯ï¼Œå‚æ•°åœ¨å±±å£çš„ä¸¤ç«¯ä¸æ–­ åœ°â€œéœ‡è¡â€ï¼ŒæŸå¤±é™ä¸ä¸‹å»ï¼Œä½†æ˜¯æ¢¯åº¦ä»ç„¶æ˜¯å¾ˆå¤§çš„ã€‚

å­¦ä¹ ç‡å°ï¼Œè°ƒåˆ° 10^âˆ’7 çš„ç»“æœå¦‚å›¾ 3.22(b) æ‰€ç¤ºï¼Œå‚æ•°ä¸å†â€œéœ‡è¡â€äº†ã€‚å‚æ•°ä¼šæ»‘åˆ°å±±è°·åº•åå·¦ è½¬ï¼Œä½†æ˜¯è¿™ä¸ªè®­ç»ƒæ°¸è¿œèµ°ä¸åˆ°ç»ˆç‚¹ã€‚

é»„è‰²å‰å·å°±æ˜¯æœ€ç»ˆæƒ³è¦è¾¾åˆ°çš„ æœ€ä¼˜å‚æ•°ä½ç½®

![Screenshot 2025-08-18 at 7.26.45â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_7.26.45_PM.png)

æ‰€ä»¥æ‰€æœ‰çš„å‚æ•°éƒ½æ˜¯è®¾åŒæ ·çš„å­¦ä¹ ç‡ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¤Ÿï¼Œå¼•å…¥è‡ªé€‚åº”å­¦ä¹ ç‡æ–¹æ³•

æ¢¯åº¦æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œå­¦ä¹ ç‡å°±å‡å°ï¼Œæ¢¯åº¦æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œå­¦ä¹ ç‡å°±æ”¾å¤§ã€‚

![Screenshot 2025-08-18 at 7.34.58â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_7.34.58_PM.png)

AdaGrad(Adaptive Gradient)

![Screenshot 2025-08-18 at 7.54.57â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_7.54.57_PM.png)

å­¦ä¹ ç‡ä» Î· æ”¹æˆ Î· / Ïƒ çš„æ—¶å€™ï¼Œå­¦ä¹ ç‡å°±å˜å¾—å‚æ•°ç›¸å…³(parameter dependent)ï¼Œå¸¸è§çš„ç±»å‹æ˜¯ç®—æ¢¯åº¦çš„å‡æ–¹æ ¹(root mean square) Ïƒ

- å› ä¸ºåˆ†æ¯ Ïƒ æŠŠè¿‡å»æ‰€æœ‰æ¢¯åº¦çš„â€œå†å²ä¿¡æ¯â€å¸¦è¿›æ¥äº†
- å¦‚æœæŸä¸ªå‚æ•°çš„æ¢¯åº¦ç»å¸¸å¾ˆå¤§ï¼Œåˆ†æ¯è¶Šæ¥è¶Šå¤§ï¼Œè¯¥å‚æ•°æ›´æ–°å¾—è¶Šæ¥è¶Šæ…¢ï¼›
- å¦‚æœæŸä¸ªå‚æ•°çš„æ¢¯åº¦ç»å¸¸å¾ˆå°ï¼Œåˆ†æ¯å¢é•¿æ…¢ï¼Œè¯¥å‚æ•°è¿˜èƒ½ç»§ç»­æ›´æ–°ã€‚

![Screenshot 2025-08-18 at 7.53.29â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_7.53.29_PM.png)

RMSprop(Root Mean Squared propagation)

![Screenshot 2025-08-18 at 8.08.24â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_8.08.24_PM.png)

è®¡ç®— Î¸ çš„æ–¹æ³•è·Ÿ AdaGrad ç®—å‡æ–¹æ ¹ä¸ä¸€æ ·ï¼ŒAdaGrad æ¯ä¸€ä¸ªæ¢¯åº¦æœ‰åŒç­‰çš„é‡è¦æ€§

- å’Œ AdaGrad ä¸åŒï¼ŒRMSProp ä¸ä¼šæŠŠæ‰€æœ‰å†å²æ¢¯åº¦éƒ½å¹³å‡ï¼Œè€Œæ˜¯ç»™â€œæœ€è¿‘çš„æ¢¯åº¦â€æ›´å¤§æƒé‡ï¼Œé€æ¸â€œé—å¿˜â€å¾ˆä¹…ä¹‹å‰çš„æ¢¯åº¦ã€‚
- Î± æ˜¯é—å¿˜å› å­ (é€šå¸¸å– 0.9 å·¦å³)ã€‚
- å¥½å¤„ï¼šé¿å…äº†å­¦ä¹ ç‡ä¸æ–­è¡°å‡åˆ°æ¥è¿‘ 0ã€‚

![Screenshot 2025-08-18 at 8.01.09â€¯PM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-18_at_8.01.09_PM.png)

æ€»ç»“ï¼š

- SGDï¼šæœ€åŸºç¡€ï¼Œæ¯æ¬¡ç”¨å°æ‰¹é‡æ•°æ®æ›´æ–°å‚æ•°ï¼Œæ›´æ–°å…¨é æ¢¯åº¦ã€‚
- Momentumï¼šé¿å…â€œæŠ–åŠ¨â€ï¼Œå‚æ•°æ›´æ–°æ—¶è€ƒè™‘â€œæƒ¯æ€§â€ï¼Œåƒå°çƒå¸¦æƒ¯æ€§å¾€ä¸‹æ»šã€‚
- RMSPropï¼šæ¯ä¸ªå‚æ•°æœ‰ç‹¬ç«‹å­¦ä¹ ç‡ï¼Œæ¢¯åº¦å¹³æ–¹çš„æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œè‡ªåŠ¨è°ƒæ•´å­¦ä¹ ç‡ï¼Œæ§åˆ¶å¤§æ¢¯åº¦æ›´æ–°å°ç‚¹ï¼Œå°æ¢¯åº¦æ›´æ–°å¤§ç‚¹ã€‚
- Adamï¼šMomentum + RMSProp ç»“åˆï¼Œä½¿ç”¨åŠ¨é‡ä½œä¸ºå‚æ•°æ›´æ–°æ–¹å‘ï¼Œå¹¶ä¸”èƒ½å¤Ÿè‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡ã€‚å¸¸ç”¨çš„ä¼˜åŒ–çš„ç­–ç•¥æˆ–è€…ä¼˜åŒ–å™¨(optimizer)æ˜¯ Adam (Adaptive moment estimation)ï¼ŒPyTorch å·²ç»é¢„è®¾ã€‚

### å­¦ä¹ ç‡è°ƒåº¦

AdaGrad å­˜åœ¨é—®é¢˜ï¼šåˆ†æ¯ Ïƒ ç´¯è®¡äº†å†å²ä¸Šæ‰€æœ‰æ¢¯åº¦çš„å¹³æ–¹ â†’ è¶Šåˆ°åé¢ï¼Œå®ƒè¶Šå¤§ã€‚æœ‰æ•ˆå­¦ä¹ ç‡ Î·/Ïƒä¼šè¶Šæ¥è¶Šå°

å­¦ä¹ ç‡è°ƒåº¦(learning rate scheduling)å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜

- åœ¨ BC ä¸Šèµ°äº†å¾ˆä¹…ï¼Œw æ–¹å‘çš„æ¢¯åº¦ä¸€ç›´å¾ˆå° â†’ Ïƒ^w å§‹ç»ˆå¾ˆå° â†’ Î·/Ïƒ^w å˜å¾—å¾ˆå¤§ï¼ˆå¯¹ w çš„æœ‰æ•ˆå­¦ä¹ ç‡è¢«â€œæ”¾å¤§â€ï¼‰ã€‚
- ä¸€åˆ° C é™„è¿‘ï¼Œå“ªæ€•å‡ºç° ä¸€ç‚¹ç‚¹éé›¶çš„ g^wï¼Œå› ä¸ºåˆ†æ¯å¾ˆå°ï¼Œæ›´æ–°é‡ | Î”w | ä¼šä¸€ä¸‹å­å˜å¾—å¾ˆå¤§ â†’ è½¨è¿¹å°±å‡ºç°äº†ç«–ç›´çš„å¤§è·³ï¼ˆçœ‹èµ·æ¥åƒâ€œçˆ†ç‚¸â€ï¼‰ã€‚
- è·³äº†å‡ æ¬¡åï¼Œw æ–¹å‘çš„æ¢¯åº¦å˜å¤§è¢«ç´¯ç§¯è¿› Ïƒ^w â†’ åˆ†æ¯å˜å¤§ â†’ æ­¥é•¿å˜å° â†’ è½¨è¿¹åˆç¨³å®šå¹¶å›åˆ°æ­£ç¡®è·¯çº¿ã€‚

![Screenshot 2025-08-19 at 1.49.26â€¯AM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-19_at_1.49.26_AM.png)

![Screenshot 2025-08-19 at 1.21.02â€¯AM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-19_at_1.21.02_AM.png)

è°ƒåº¦ç­–ç•¥ï¼š

1. å­¦ä¹ ç‡è¡°å‡(learning rate decay)ï¼Œä¹Ÿç§°ä¸ºå­¦ä¹ ç‡é€€ç«(learning rate annealing)
    - åŠ äº†å­¦ä¹ ç‡è°ƒåº¦ï¼ŒÎ· åœ¨åæœŸè¶Šæ¥è¶Šå°ï¼Œå³ä½¿åˆ†æ¯ Ïƒ å°ï¼Œä¹Ÿèƒ½æŠµæ¶ˆæ‰åˆ†æ¯å¸¦æ¥çš„å½±å“ï¼Œæ­¥ä¼ç¨³å®šã€å¹³é¡ºï¼Œæœ€åé¡ºåˆ©æ”¶æ•›ã€‚é˜²æ­¢å®ƒåœ¨çº¢åœˆå¤„çªç„¶â€œçˆ†ç‚¸â€ã€‚
    - åˆ°è¾¾æŒ‡å®š step å°±ä¹˜ä»¥ä¸€ä¸ªå› å­ï¼ˆå¦‚ 0.1ï¼‰ï¼Œå¤§æ­¥æ¢ç´¢ï¼Œé€æ¸å‡å°æ­¥ä¼ï¼Œæ”¶æ•›æ›´ç¨³å®šã€‚
2. Learning Rate Warmupï¼ˆå­¦ä¹ ç‡é¢„çƒ­ï¼‰ï¼Œå®ƒåœ¨æ·±åº¦å­¦ä¹ é‡Œéå¸¸å¸¸è§ï¼Œç‰¹åˆ«æ˜¯åœ¨ ResNetã€BERTã€Transformer è¿™ç±»å¤§æ¨¡å‹çš„è®­ç»ƒä¸­
    - åˆšå¼€å§‹è®­ç»ƒæ—¶ï¼Œè®©å­¦ä¹ ç‡å…ˆå˜å¤§åå˜å°ï¼Œè‡³äºå˜åˆ°å¤šå¤§ã€å˜å¤§çš„é€Ÿåº¦ã€å˜å°çš„é€Ÿåº¦æ˜¯è¶…å‚æ•°ã€‚é¿å…åœ¨å‚æ•°éšæœºã€ç»Ÿè®¡é‡ä¸ç¨³å®šæ—¶ç”¨å¤§å­¦ä¹ ç‡å¯¼è‡´â€œä¹±è·³â€ã€‚

# ä¼˜åŒ–æ€»ç»“

è¿™ä¸ªæ˜¯ç›®å‰ä¼˜åŒ–çš„å®Œæ•´çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬é‡Œé¢æœ‰åŠ¨é‡ï¼Œå…¶ä¸æ˜¯é¡ºç€æŸä¸ªæ—¶åˆ»ç®—å‡ºçš„æ¢¯åº¦æ–¹å‘æ¥æ›´æ–°å‚æ•°ï¼Œè€Œæ˜¯æŠŠè¿‡å»æ‰€æœ‰ç®—å‡ºæ¢¯åº¦çš„æ–¹å‘åšä¸€ä¸ªåŠ æƒæ€»å’Œå½“ä½œæ›´æ–°çš„æ–¹å‘ã€‚

æ­¥ä¼å¤§å°ä¸º m / Ïƒ ã€‚æœ€åé€šè¿‡ Î· æ¥å®ç°å­¦ä¹ ç‡è°ƒåº¦

![Screenshot 2025-08-19 at 3.09.42â€¯AM.png](%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%20252c20f97e768064a670c9159b442b3e/Screenshot_2025-08-19_at_3.09.42_AM.png)

åŠ¨é‡ mï¼šæ–¹å‘æ€§ç´¯ç§¯ï¼ˆæ­£è´Ÿèƒ½æŠµæ¶ˆï¼‰ã€‚è´Ÿè´£â€œæœå“ªä¸ªæ–¹å‘èµ° + èµ°å¤šå¿«â€ã€‚

å‡æ–¹æ ¹ Ïƒï¼šèƒ½é‡ç´¯ç§¯ï¼ˆå¹³æ–¹ â†’ å…¨æ˜¯æ­£æ•°ï¼Œæ²¡æ³•æŠµæ¶ˆï¼‰ã€‚è´Ÿè´£â€œæ§åˆ¶å°ºåº¦ï¼Œåˆ«èµ°å¾—å¤ªçŒ›â€ã€‚

åŠ¨é‡ â†’ å¹³æ»‘æ–¹å‘ã€‚å‡æ–¹æ ¹ â†’ æ§åˆ¶æ­¥é•¿ã€‚

ç»“åˆèµ·æ¥ â†’ Adam çš„æ ¸å¿ƒæ€æƒ³ âœ…

# åˆ†ç±»

ä¸ºä»€ä¹ˆåˆ†ç±»è¿‡ç¨‹ä¸­è¦åŠ ä¸Š softmax å‡½æ•°?